<cmdb-content-header title="Object list"></cmdb-content-header>

<table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-bordered">
  <ng-container *ngFor="let results of objectLists">
    <thead>
    <tr>
      <th class="toggle-check nosort" style="text-align: center"><input type="checkbox" class="select-all-checkbox" (click)="selectAll()">
      </th>

      <th class="toggle-active">Active</th>
      <th class="toggle-id">ID</th>
      <th class="toggle-type">Type</th>
      <!-- BEGIN: summarie fields : show only if objects are categorized -->
      <ng-container *ngIf="hasSummaries">
        <ng-container *ngFor="let obj of results.columnFields;">
            <th class="toggle-{{obj.name}}">{{obj.label}}</th>
        </ng-container>
      </ng-container>
      <!-- END: summarie fields -->
      <th class="toggle-autor">Author</th>
      <th class="toggle-last-modified">Last modified</th>
      <th class="toggle-action">Action</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let result of results.items">

      <td style="text-align: center"><input id="{{result.public_id}}" class="select-checkbox" type="checkbox" (click)="updateDisplay()"></td>

      <td>
        <cmdb-active-badge [activeStatus]="result.active"></cmdb-active-badge>
      </td>
      <td>{{result.public_id}}</td>
      <td><a routerLink="/framework/type/{{result.type_id}}">{{result.label}}</a></td>

      <!-- BEGIN: summarie contens : show only if objects are categorized  -->
      <ng-container *ngIf="hasSummaries" >
        <ng-container *ngFor="let field of result.fields">
          <td><span [innerHTML]="checkType(field.value)">{{field.value}}</span></td>
        </ng-container>
      </ng-container>
      <!-- END: summarie contens -->

      <td>{{result.author_name}}</td>
      <td>{{result.last_edit_time?.$date | date:"dd/MM/yy - hh:mm:ss"}}</td>
      <td>
        <a class="text-dark"[routerLink]="['/framework/object/', result.public_id]">
          <i class="fa fa-eye" aria-hidden="true"></i>
        </a>
        <a class="ml-1 text-dark" [routerLink]="['/framework/object/', result.public_id]">
          <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
        </a>
        <a class="ml-1 text-dark" (click)="delObject(result)">
          <i class="fa fa-trash-o" aria-hidden="true"></i>
        </a>
      </td>
    </tr>
    </tbody>
  </ng-container>
</table>

<!-- Modal : insert new object-->
<cmdb-object-insert></cmdb-object-insert>
