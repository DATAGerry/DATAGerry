<h1>Type list</h1>
<hr/>

<table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-bordered">
  <thead>
  <tr>
    <th>Active</th>
    <th>Public ID</th>
    <th>Type</th>
    <th>Author</th>
    <th>Creation time</th>
    <th>Action</th>
    <th>Cleanup Database</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let typeInstance of typeList">
    <td>
      <cmdb-active-badge [activeStatus]="typeInstance.active"></cmdb-active-badge>
    </td>
    <td scope="row">{{typeInstance.public_id}}</td>
    <td><cmdb-type-label [faIcon]="typeInstance?.render_meta?.icon" [title]="typeInstance.label"></cmdb-type-label></td>
    <td>{{userService?.findUser(typeInstance?.author_id).user_name }}</td>
    <td>{{typeInstance.creation_time.$date | date:"dd/MM/yy - hh:mm:ss"}}</td>
    <td>
      <a class="text-dark" routerLink="/framework/type/edit/{{typeInstance.public_id}}">
        <fa-icon [icon]="['far', 'edit']"></fa-icon>
      </a>
      <a class="ml-1 text-dark" [routerLink]="['/framework/type/add/']" [queryParams]="{copy: typeInstance.public_id}">
        <fa-icon [icon]="['far', 'clone']"></fa-icon>
      </a>
      <a class="ml-1 text-dark" routerLink="/framework/type/delete/{{typeInstance.public_id}}">
        <fa-icon [icon]="['far', 'trash-alt']"></fa-icon>
      </a>
    </td>
    <td>
      <fieldset [disabled]="typeInstance.clean_db !== false ? true : false">
        <button type="button" class="btn badge-pill" (click)="cleanupDatabase(typeInstance)"
                data-toggle="modal" data-target="#cleanup-progress-modal"
                [ngClass]="typeInstance.clean_db === false ? 'btn-danger' : 'btn-success'">clean
          <fa-icon *ngIf="typeInstance.clean_db === false" icon="exclamation-circle"></fa-icon>
          <fa-icon *ngIf="typeInstance.clean_db !== false" icon="check-circle"></fa-icon>
        </button>
      </fieldset>
    </td>
  </tr>
  </tbody>
</table>


<!-- cleanup-progress-modal -->
<div class="modal fade" id="cleanup-progress-modal"
     data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="cleanup-progress-modal"
     aria-hidden="true">
  <div class="modal-dialog" role="document">
    <!--Content-->
    <div class="modal-content">
      <!--Header-->
      <div class="modal-header">
        <h4 class="modal-title"><fa-icon icon="broom"></fa-icon> Cleanup Database</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="white-text">&times;</span>
        </button>
      </div>

      <!--Body-->
      <div class="modal-body">
        <div class="card-body">
          <h5>Remove fields</h5>
          <div class="progress">
            <div class="progress-bar progress-bar-animated progress-bar-striped" role="progressbar"
                 [ngClass]="remove ? 'bg-success' : 'bg-primary'"
                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width:100%">
            </div>
          </div>
          <ng-container *ngIf="!remove"><p class="text-right">in process <fa-icon icon="exclamation"></fa-icon></p></ng-container>
          <ng-container *ngIf="remove"><p class="text-right">done <fa-icon icon="check"></fa-icon></p></ng-container>

          <h5>Update fields</h5>
          <div class="progress">
            <div class="progress-bar progress-bar-striped" role="progressbar"
                 [ngClass]="update ? 'bg-success' : 'bg-primary'"
                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width:100%">
            </div>
          </div>
          <ng-container *ngIf="!update"><p class="text-right">in process <fa-icon icon="exclamation"></fa-icon></p></ng-container>
          <ng-container *ngIf="update"><p class="text-right">done <fa-icon icon="check"></fa-icon></p></ng-container>
        </div>
      </div>

      <!--Footer-->
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Done</button>
      </div>
    </div>
    <!--/.Content-->
  </div>
</div>
<!-- cleanup-progress-modal-->
