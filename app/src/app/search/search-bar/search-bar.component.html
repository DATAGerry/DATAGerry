<form [formGroup]="searchBarForm" id="search-bar">
  <cmdb-search-bar-tags *ngFor="let tag of tags" [tag]="tag" (changeEmitter)="updateTag($event)"
                        (deleteEmitter)="removeTag($event)">
    {{tag.searchText}}
  </cmdb-search-bar-tags>
  <input class="search-input" type="text" #tagInput [formControl]="inputControl"/>
  <div class="search-bar-append">
    <button *ngIf="tags.length > 0" (click)="clearAll()" type="button"><span>&times;</span></button>
    <button (click)="callSearch()" type="button"><i class="fas fa-search"></i></button>
  </div>
  <ul tabindex="1" #inputDropdown *ngIf="inputControl.value.toString().length > 0" id="search-bar-accordion"
      class="accordion">
    <li (click)="addTag('text')">
      <span>
        <button class="btn btn-link" type="button">
          <i class="fas fa-caret-right"></i>
        </button>
        <i>Text</i>: {{inputControl.value}} - <i>({{possibleTextResults}})</i>
      </span>
    </li>
    <li *ngIf="possibleTypes && possibleTypes.length > 0">
      <span>
        <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#search-bar-collapse-type">
          <i class="fas fa-caret-right"></i>
        </button>
        <span (click)="addTag('type', possibleTypes)"><i>Types</i>: {{inputControl.value}}
          - <i>({{possibleTypes.length}})</i></span>
      </span>
      <ul id="search-bar-collapse-type" class="collapse" data-parent="#search-bar-accordion">
        <li *ngFor="let possibleType of possibleTypes; let i = index"
            (click)="addTag('type', [possibleType])">{{possibleType?.label}}</li>
      </ul>
    </li>
    <li *ngIf="possibleCategories && possibleCategories.length > 0">
      <span>
      <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#search-bar-collapse-categories">
        <i class="fas fa-caret-right"></i>
      </button>
        <span (click)="addTag('category', possibleCategories)">
          <i>Categories</i>: {{inputControl.value}} - <i>({{possibleCategories.length}})</i>
        </span>
      </span>
      <ul id="search-bar-collapse-categories" class="collapse" data-parent="#search-bar-accordion">
        <li *ngFor="let possibleCategory of possibleCategories; let i = index"
            (click)="addTag('category', [possibleCategory])">{{possibleCategory?.label}}</li>
      </ul>
    </li>
  </ul>
</form>
