{% from 'includes/_render_table_macros.html' import render_table with context %}
{% from 'includes/_render_macros.html' import render_summaries, render_matched_fields with context %}
{% set _table_content %}
{% for result in results %}

    <tr>
        <td>{{ result.object_instance.active | label_active }}</td>
        <td>
            <a href="/object/{{ result.object_instance.public_id }}">
                {{ result.object_instance.public_id }}
            </a>
        </td>
        <td>
            <a href="/type/{{ result.type_instance.get_public_id() }}">
                {{ result.type_instance.get_label() }}
            </a>
        </td>
        {% if text_search %}
            <td>{{ render_matched_fields(result.matched_fields) }}</td>
            <td>{{ result.matched_fields | length }}</td>
        {% endif %}
        <td>{{ render_summaries(result.get_summaries()) }}</td>
        <td>{{ result.object_instance.version }}</td>
        <td>
            <a href="/user/{{ result.object_instance.author_id }}/">
                {{ user_manager.get_user(result.object_instance.author_id).get_name() }}
            </a>
        </td>
    </tr>
{% endfor %}
{% endset %}
<div class="card">
    <div class="card-header">
        Results <span class="badge badge-secondary float-right mr-1">Total: {{ results_counter }}</span>
    </div>
    <div class="card-body">
        {% if text_search %}
            {{ render_table(headlines=["Active", "Public ID", "Type", "Matched fields", "Count", "Summary", "Version", "Author"],
                                content=_table_content, data_order='[[ 4, "desc" ]]') }}
        {% else %}
            {{ render_table(headlines=["Active", "Public ID", "Type", "Summary", "Version", "Author"],
                                content=_table_content, data_order='[[ 1, "desc" ]]') }}
        {% endif %}
    </div>
</div>