{% extends 'layout.html' %}
{% block title %}User Management | Overview{% endblock %}
{% block navigation %}
    {% include 'includes/_navigation.html' %}
{% endblock %}
{% block breadcrumb %}
    {% include 'includes/_breadcrumb.html' %}
{% endblock %}
{% block content %}
    <div class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-10">
                    <h1>User Management</h1>
                    <hr/>
                    {% set user_list = user_manager.get_all_users() %}
                    {% if user_list|length > 0 %}
                        <table data-order='[[ 0, "asc" ]]' class="table table-hover data_table">
                            <thead class="thead thead-light">
                            <tr>
                                <th scope="col">#ID</th>
                                <th scope="col">Username</th>
                                <th scope="col">Name</th>
                                <th scope="col">Group</th>
                                <th scope="col">Registration time</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for current_user in user_list %}
                                <tr>
                                    <td>{{ current_user.get_public_id() }}</td>
                                    <td>
                                        <a href="/user/{{ current_user.get_public_id() }}">{{ current_user.get_username() }}</a>
                                    </td>
                                    <td>
                                        {{ current_user.get_name() }}
                                    </td>
                                    <td>
                                        <a href="/settings/user-management/groups/#group_{{ user_manager.get_group(current_user.group_id).get_name() }}">
                                            {{ user_manager.get_group(current_user.group_id).get_name() }}
                                        </a>
                                    </td>
                                    <td>{{ current_user.registration_time }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    {% endif %}
                    <h2 class="mt-3">Add new user</h2>
                    <hr/>
                    <form action="{{ request.url_rule }}add_user/" method="post" novalidate>
                        <div class="form-group">
                            <label for="user_name">Username<span class="text-primary">*</span></label>
                            <input type="text" class="form-control" name="user_name" id="user_name"
                                   aria-describedby="user_name_help" required/>
                            <small id="user_name_help" class="form-text text-muted">Enter unique username</small>
                        </div>
                        <div class="form-group">
                            <label for="password">Password<span class="text-primary">*</span></label>
                            <input type="password" class="form-control" name="password" id="password"
                                   aria-describedby="password_help" required/>
                            <small id="password_help" class="form-text text-muted">The password must be at least 8
                                characters long and contain the following characters and special characters: 1 capital
                                letter, 1 special character
                            </small>
                        </div>
                        <div class="form-group">
                            <label for="email">E-Mail</label>
                            <input type="email" class="form-control" name="email" id="email"/>
                        </div>
                        <div class="form-group">
                            <label for="first_name">Firstname</label>
                            <input type="text" class="form-control" name="first_name" id="first_name"/>
                        </div>
                        <div class="form-group">
                            <label for="last_name">Lastname</label>
                            <input type="text" class="form-control" name="last_name" id="last_name"/>
                        </div>
                        <div class="form-group">
                            <label for="group_id">Group<span class="text-primary">*</span></label>
                            {% set group_list = user_manager.get_all_groups() %}
                            <select id="group_id" name="group_id" class="custom-select" required>
                                {% for group in group_list %}
                                    <option value="{{ group.get_public_id() }}">{{ group.get_name() }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <input type="text" name="submit_token" id="submit_token" value="{{ user_submit_token }}" hidden>
                        <button type="submit" class="btn btn-primary">Submit</button>
                        <button type="reset" class="btn btn-outline-secondary">Reset</button>
                    </form>
                </div>
                <div class="col-2">
                    {% include 'settings/user_management/_sidebar.html' %}
                </div>
            </div>
            {{ super() }}
        </div>
    </div>
{% endblock %}
{% if mode == 'DEBUG' %}
    {% block debug %}
        <h2>User list</h2>
        <hr>
        <pre>{{ user_manager.get_all_users() }}</pre>
    {% endblock %}
{% endif %}